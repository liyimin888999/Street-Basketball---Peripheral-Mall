"use strict";define(["jquery","cookie"],function(i){function n(){var n=this;this.container=i("#header-container"),this.load().then(function(){n.search(),n.isLogin(),n.calcCartNum()})}return i.extend(n.prototype,{load:function(){var t=this;return new Promise(function(n){t.container.load("/html/module/header.html",function(){n()})})},search:function(){var n=this;i("#search-input").on("keyup",function(){n.inputValue=i(this).val(),n.addUl(n.inputValue)}).blur(function(){setTimeout(function(){i("#uls").hide()},100),i("#uls").on("click","li",function(){i("#search-input").val(i(this).html())})}).focus(function(){n.inputValue=i("#search-input").val(),n.addUl(n.inputValue)})},addUl:function(n){n?(i("#uls").remove(),i.getJSON("https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?cb=?&wd="+n,function(n){var t=n.s;0!==t.length&&(i(".search-input").append("<ul id='uls'>"),t.forEach(function(n,t){i("#uls").append("<li>"+n+"</li>")}))})):i("#uls").hide()},isLogin:function(){var n=this;this.loginBtn=i("#login-btn"),this.afterLogin=i("#after-login"),this.nameSpan=i("#name"),this.logout=i("#exit");var t=i.cookie("username");t&&(this.loginBtn.hide(),this.afterLogin.show(),this.nameSpan.html(t)),this.logout.on("click",function(){confirm("确定要退出吗？")&&(i.removeCookie("username",{path:"/"}),n.loginBtn.show(),n.afterLogin.hide())})},calcCartNum:function(){var n=localStorage.getItem("cart"),t=0;n&&(t=(n=JSON.parse(n)).reduce(function(n,t){return n+=Number(t.num)},0)),i("#cart-num").html(t)}}),new n});